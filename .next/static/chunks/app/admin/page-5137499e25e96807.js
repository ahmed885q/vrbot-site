(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{9838:function(e,i,t){Promise.resolve().then(t.bind(t,805))},805:function(e,i,t){"use strict";t.r(i),t.d(i,{default:function(){return l}});var n=t(3827),s=t(4090);function l(){let[e,i]=(0,s.useState)([]),[t,l]=(0,s.useState)(!0),[r,d]=(0,s.useState)(null),[a,o]=(0,s.useState)(null),[u,c]=(0,s.useState)(""),h=(0,s.useMemo)(()=>{let i=u.trim().toLowerCase();return i?e.filter(e=>(e.email||"").toLowerCase().includes(i)||e.id.toLowerCase().includes(i)):e},[e,u]);async function p(){l(!0),o(null);let e=await fetch("/api/admin/users/list",{cache:"no-store"});if(!e.ok){let i=await e.json().catch(()=>({}));o((null==i?void 0:i.error)||"Failed to load users"),l(!1);return}i((await e.json()).users||[]),l(!1)}async function f(e,i){d(e),o(null);let t=await fetch("/api/admin/users/set-role",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({userId:e,role:i})});if(!t.ok){let e=await t.json().catch(()=>({}));o((null==e?void 0:e.error)||"Failed to set role"),d(null);return}d(null),await p()}return(0,s.useEffect)(()=>{p()},[]),(0,n.jsxs)("div",{style:{marginTop:32,padding:16,border:"1px solid #ddd",borderRadius:12},children:[(0,n.jsx)("h2",{style:{fontSize:20,fontWeight:700},children:"User Roles"}),(0,n.jsxs)("div",{style:{marginTop:12,display:"flex",gap:8},children:[(0,n.jsx)("input",{placeholder:"Search by email or user id…",value:u,onChange:e=>c(e.target.value),style:{flex:1,padding:6}}),(0,n.jsx)("button",{onClick:p,disabled:t,children:"Refresh"})]}),a&&(0,n.jsx)("p",{style:{color:"red",marginTop:10},children:a}),t?(0,n.jsx)("p",{style:{marginTop:12},children:"Loading…"}):(0,n.jsxs)("div",{style:{marginTop:12},children:[h.map(e=>(0,n.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr auto auto",gap:10,alignItems:"center",padding:"10px 0",borderBottom:"1px solid #eee"},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{fontWeight:600},children:e.email||"(no email)"}),(0,n.jsx)("div",{style:{fontSize:12,opacity:.7},children:e.id})]}),(0,n.jsx)("button",{onClick:()=>f(e.id,"admin"),disabled:r===e.id,children:r===e.id?"...":"Make Admin"}),(0,n.jsx)("button",{onClick:()=>f(e.id,"user"),disabled:r===e.id,children:r===e.id?"...":"Make User"})]},e.id)),0===h.length&&(0,n.jsx)("p",{style:{marginTop:12},children:"No users found."})]})]})}}},function(e){e.O(0,[971,69,744],function(){return e(e.s=9838)}),_N_E=e.O()}]);