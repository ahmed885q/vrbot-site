"use strict";(()=>{var e={};e.id=3744,e.ids=[3744],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2081:e=>{e.exports=require("child_process")},6113:e=>{e.exports=require("crypto")},2361:e=>{e.exports=require("events")},3685:e=>{e.exports=require("http")},5687:e=>{e.exports=require("https")},3837:e=>{e.exports=require("util")},4237:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>x,originalPathname:()=>g,patchFetch:()=>E,requestAsyncStorage:()=>_,routeModule:()=>h,serverHooks:()=>f,staticGenerationAsyncStorage:()=>v,staticGenerationBailout:()=>S});var s={};t.r(s),t.d(s,{POST:()=>m,dynamic:()=>l,runtime:()=>c});var o=t(5419),i=t(9108),a=t(9678),u=t(8070),n=t(8291),p=t(1010);let c="nodejs",l="force-dynamic",d=new n.Z(process.env.STRIPE_SECRET_KEY);async function m(e){try{let{userId:r}=await e.json();if(!r)return u.Z.json({error:"Missing userId"},{status:400});let{data:t,error:s}=await p.p.from("subscriptions").select("stripe_customer_id").eq("user_id",r).maybeSingle();if(s)return u.Z.json({error:s.message},{status:500});if(!t?.stripe_customer_id)return u.Z.json({error:"No stripe_customer_id for this user"},{status:400});let o=await d.billingPortal.sessions.create({customer:t.stripe_customer_id,return_url:"https://www.vrbot.me/dashboard"});return u.Z.json({url:o.url})}catch(e){return u.Z.json({error:e?.message||"Failed"},{status:500})}}let h=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/stripe/portal/route",pathname:"/api/stripe/portal",filename:"route",bundlePath:"app/api/stripe/portal/route"},resolvedPagePath:"/workspaces/vrbot-site/app/api/stripe/portal/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:_,staticGenerationAsyncStorage:v,serverHooks:f,headerHooks:x,staticGenerationBailout:S}=h,g="/api/stripe/portal/route";function E(){return(0,a.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:v})}},1010:(e,r,t)=>{t.d(r,{p:()=>s});let s=(0,t(3950).eI)(process.env.SUPABASE_URL,process.env.SUPABASE_SERVICE_ROLE_KEY,{auth:{autoRefreshToken:!1,persistSession:!1}})}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[1638,6206,3950,8291],()=>t(4237));module.exports=s})();