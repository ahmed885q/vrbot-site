"use strict";(()=>{var e={};e.id=2052,e.ids=[2052],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},47922:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>j,originalPathname:()=>k,patchFetch:()=>y,requestAsyncStorage:()=>h,routeModule:()=>g,serverHooks:()=>v,staticGenerationAsyncStorage:()=>x,staticGenerationBailout:()=>I});var s={};r.r(s),r.d(s,{POST:()=>m,runtime:()=>l});var a=r(95419),i=r(69108),n=r(99678),o=r(78070),c=r(7439),d=r(77497),u=r(6113),p=r.n(u);let l="nodejs";async function m(e){let t=(0,c.cookies)(),r=(0,d.createServerClient)("https://xmanyfpojzkjlwatkrcc.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhtYW55ZnBvanpramx3YXRrcmNjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc2MTc0MTcsImV4cCI6MjA4MzE5MzQxN30.LFW6cNE-oM_Ah8dQL2Dt1xMw8rRWxbHAfPdRnkRvW_U",{cookies:{getAll:()=>t.getAll(),setAll:e=>{try{e.forEach(({name:e,value:r,options:s})=>t.set(e,r,s))}catch{}}}}),{data:s}=await r.auth.getUser(),a=s?.user;if(!a)return o.Z.json({error:"Unauthorized"},{status:401});let i=await e.json().catch(()=>({})),n=String(i?.deviceName??"Windows Agent").trim()||"Windows Agent",u="dev_"+p().randomBytes(24).toString("hex"),l=p().createHash("sha256").update(u).digest("hex"),{data:m,error:g}=await r.from("bot_devices").insert({user_id:a.id,device_name:n,token_hash:l,last_seen_at:null}).select("id, device_name, created_at").single();return g?o.Z.json({error:g.message},{status:500}):o.Z.json({ok:!0,token:u,device:m})}let g=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/devices/register/route",pathname:"/api/devices/register",filename:"route",bundlePath:"app/api/devices/register/route"},resolvedPagePath:"/workspaces/vrbot-site/app/api/devices/register/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:h,staticGenerationAsyncStorage:x,serverHooks:v,headerHooks:j,staticGenerationBailout:I}=g,k="/api/devices/register/route";function y(){return(0,n.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:x})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[1638,6206,3950,7439,7497],()=>r(47922));module.exports=s})();