(()=>{var e={};e.id=3,e.ids=[3],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},2218:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>a.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>c,routeModule:()=>h,tree:()=>d});var s=r(482),i=r(9108),n=r(2563),a=r.n(n),o=r(8300),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let d=["",{children:["admin",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,6746)),"/workspaces/vrbot-site/app/admin/page.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,6294)),"/workspaces/vrbot-site/app/admin/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,2917)),"/workspaces/vrbot-site/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,9361,23)),"next/dist/client/components/not-found-error"]}],c=["/workspaces/vrbot-site/app/admin/page.tsx"],p="/admin/page",u={require:r,loadChunk:()=>Promise.resolve()},h=new s.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/admin/page",pathname:"/admin",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},7048:(e,t,r)=>{Promise.resolve().then(r.bind(r,8728))},2919:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2583,23)),Promise.resolve().then(r.t.bind(r,6840,23)),Promise.resolve().then(r.t.bind(r,8771,23)),Promise.resolve().then(r.t.bind(r,3225,23)),Promise.resolve().then(r.t.bind(r,9295,23)),Promise.resolve().then(r.t.bind(r,3982,23))},5303:()=>{},8728:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});var s=r(5344),i=r(3729);function n(){let[e,t]=(0,i.useState)([]),[r,n]=(0,i.useState)(!0),[a,o]=(0,i.useState)(null),[l,d]=(0,i.useState)(null),[c,p]=(0,i.useState)(""),u=(0,i.useMemo)(()=>{let t=c.trim().toLowerCase();return t?e.filter(e=>(e.email||"").toLowerCase().includes(t)||e.id.toLowerCase().includes(t)):e},[e,c]);async function h(){n(!0),d(null);let e=await fetch("/api/admin/users/list",{cache:"no-store"});if(!e.ok){let t=await e.json().catch(()=>({}));d(t?.error||"Failed to load users"),n(!1);return}t((await e.json()).users||[]),n(!1)}async function m(e,t){o(e),d(null);let r=await fetch("/api/admin/users/set-role",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({userId:e,role:t})});if(!r.ok){let e=await r.json().catch(()=>({}));d(e?.error||"Failed to set role"),o(null);return}o(null),await h()}return(0,i.useEffect)(()=>{h()},[]),(0,s.jsxs)("div",{style:{marginTop:32,padding:16,border:"1px solid #ddd",borderRadius:12},children:[s.jsx("h2",{style:{fontSize:20,fontWeight:700},children:"User Roles"}),(0,s.jsxs)("div",{style:{marginTop:12,display:"flex",gap:8},children:[s.jsx("input",{placeholder:"Search by email or user id…",value:c,onChange:e=>p(e.target.value),style:{flex:1,padding:6}}),s.jsx("button",{onClick:h,disabled:r,children:"Refresh"})]}),l&&s.jsx("p",{style:{color:"red",marginTop:10},children:l}),r?s.jsx("p",{style:{marginTop:12},children:"Loading…"}):(0,s.jsxs)("div",{style:{marginTop:12},children:[u.map(e=>(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr auto auto",gap:10,alignItems:"center",padding:"10px 0",borderBottom:"1px solid #eee"},children:[(0,s.jsxs)("div",{children:[s.jsx("div",{style:{fontWeight:600},children:e.email||"(no email)"}),s.jsx("div",{style:{fontSize:12,opacity:.7},children:e.id})]}),s.jsx("button",{onClick:()=>m(e.id,"admin"),disabled:a===e.id,children:a===e.id?"...":"Make Admin"}),s.jsx("button",{onClick:()=>m(e.id,"user"),disabled:a===e.id,children:a===e.id?"...":"Make User"})]},e.id)),0===u.length&&s.jsx("p",{style:{marginTop:12},children:"No users found."})]})]})}},6294:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});var s=r(5036),i=r(867),n=r(6569);async function a({children:e}){let t=(0,n.j)(),{data:r}=await t.auth.getUser(),a=r?.user;a||(0,i.redirect)("/admin/login");let{data:o}=await t.from("user_roles").select("role").eq("user_id",a.id).maybeSingle();return o&&"admin"===o.role||(0,i.redirect)("/dashboard"),s.jsx(s.Fragment,{children:e})}},6746:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>p,dynamic:()=>d});var s=r(5036),i=r(7439);let n=(0,r(6843).createProxy)(String.raw`/workspaces/vrbot-site/app/admin/components/UserRoleManager.tsx`),{__esModule:a,$$typeof:o}=n,l=n.default,d="force-dynamic";async function c(){let e=(0,i.headers)().get("host"),t=await fetch(`https://${e}/api/admin/early-access`,{cache:"no-store"});return t.ok?t.json():[]}async function p(){let e=await c();return(0,s.jsxs)("div",{style:{padding:24},children:[s.jsx("h1",{style:{fontSize:32,fontWeight:700},children:"Admin Dashboard"}),(0,s.jsxs)("div",{style:{marginTop:24},children:[s.jsx("h2",{style:{fontSize:20,fontWeight:600},children:"Early Access"}),0===e.length?s.jsx("p",{style:{marginTop:12},children:"No early access entries."}):(0,s.jsxs)("table",{style:{width:"100%",marginTop:12,borderCollapse:"collapse"},children:[s.jsx("thead",{children:(0,s.jsxs)("tr",{children:[s.jsx("th",{style:{textAlign:"left",borderBottom:"1px solid #ddd",padding:8},children:"Email"}),s.jsx("th",{style:{textAlign:"left",borderBottom:"1px solid #ddd",padding:8},children:"Created At"})]})}),s.jsx("tbody",{children:e.map(e=>(0,s.jsxs)("tr",{children:[s.jsx("td",{style:{padding:8,borderBottom:"1px solid #eee"},children:e.email}),s.jsx("td",{style:{padding:8,borderBottom:"1px solid #eee"},children:new Date(e.created_at).toLocaleString()})]},e.id))})]})]}),s.jsx(l,{})]})}},2917:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var s=r(5036);function i({children:e}){return s.jsx("html",{lang:"en",children:s.jsx("body",{children:e})})}},6569:(e,t,r)=>{"use strict";r.d(t,{j:()=>n});var s=r(7439),i=r(7497);function n(){let e=(0,s.cookies)(),t=process.env.SUPABASE_URL,r=process.env.SUPABASE_ANON_KEY;return(0,i.createServerClient)(t,r,{cookies:{getAll:()=>e.getAll(),setAll(t){try{t.forEach(({name:t,value:r,options:s})=>{e.set(t,r,s)})}catch{}}}})}}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[1638,3950,7439,8356,7497,5800],()=>r(2218));module.exports=s})();